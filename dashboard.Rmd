---
title: "dashboard"
author: "shichi"
date: "`r Sys.time()`"
output: 
  flexdashboard::flex_dashboard:
    orientation: "row"
    theme: flatly

---

```{r setup, include=FALSE}
library(flexdashboard)
library(ggplot2)
library(data.table)
library(formattable)
library(tidyr)
library(plotly)
library(fortunes)
output.dt <- matrix(sample(-1000000:1000000,372),31,12) %>% data.table()
colnames(output.dt) <- c("1","2","3","4","5","6","7","8","9","10","11","12")


```


row {data-height=30%}
----

### card1 {data-width=40%}

```{r}
valueBox(1160000, 
         caption = "Total Asset",
         icon = "glyphicon glyphicon-yen",
         color = ifelse(1160000 < 2000000, "warning", "success")
         )
```

### card2 {data-width=40%}

```{r}
valueBox(100000, 
         caption = "Total Stock",
         icon = "glyphicon glyphicon-tint",
         color = ifelse(100000 > 200000, "warning", "success")
         )
```

### card3 {data-width=20%}

```{r}
valueBox(150000, 
         caption = "Tax limit",
         icon = "glyphicon glyphicon-flag",
         color = ifelse(150000 < 100000, "warning", "success")
         )
```

column {data-height=40%}
----

### Assets  {data-width=80%}

```{r}
data <- t(USPersonalExpenditure)
data <- data.frame("year"=rownames(data), data)

p <- plot_ly(data, x = ~year, y = ~Food.and.Tobacco, name = 'Food and Tobacco', type = 'scatter', mode = 'none', fill = 'tozeroy', fillcolor = '#97D1C7', showlegend = FALSE) %>%
  add_trace(y = ~Household.Operation, name = 'Household Operation', fillcolor = '#73ABC2') %>%
  add_trace(y = ~Medical.and.Health, name = 'Medical and Health', fillcolor = '#FFE581') %>%
  add_trace(y = ~Personal.Care, name = 'Personal Care', fillcolor = '#F58A88') %>%
  add_trace(y = ~Private.Education, name = 'Private Education', fillcolor = '#7F807F') %>%
  layout(xaxis = list(title = "",
                      showgrid = FALSE),
         yaxis = list(title = "Expenditures (",
                      showgrid = FALSE))

p

```

### Pie  {data-width=20%}

```{r}
data <- t(USPersonalExpenditure)
data2 <- data/rowSums(data)*100
data2 <- data.frame("year"=rownames(data2), data2)

# Transforming into a cumulative table:
for (i in c(6:3)) {
  data2[,i-1] <- data2[,i-1] + data2[,i]
}

p <- plot_ly(data2, x = ~year, y = ~Food.and.Tobacco, name = 'Food and Tobacco', type = 'scatter', mode = 'none', fill = 'tozeroy', fillcolor = '#97D1C7', showlegend = FALSE) %>%
  add_trace(y = ~Household.Operation, name = 'Household Operation', fillcolor = '#73ABC2') %>%
  add_trace(y = ~Medical.and.Health, name = 'Medical and Health', fillcolor = '#FFE581') %>%
  add_trace(y = ~Personal.Care, name = 'Personal Care', fillcolor = '#F58A88') %>%
  add_trace(y = ~Private.Education, name = 'Private Education', fillcolor = '#7F807F') %>%
  layout(title = 'United States Personal Expenditures by Categories',
         xaxis = list(title = "",
                      showgrid = FALSE),
         yaxis = list(title = "Proportion from the Total Expenditures",
                      showgrid = FALSE,
                      ticksuffix = '%'))


p
```


column {data-height=20%}
----

### Data {data-width=50%}

```{r}

```

### List {data-width=50%}

```{r}

```
